import React, { useEffect } from 'react';
import * as Cesium from 'cesium';
import "cesium/Build/CesiumUnminified/Widgets/widgets.css";
const satellite = require('satellite.js');

// Two fake TLE data for testing
const tle_list = [
  {
    name: 'ISS (ZARYA)',
    tleLine1: '1 25544U 98067A   08264.51782528 -.00002182  00000-0 -11606-4 0  2927',
    tleLine2: '2 25544  51.6416 247.4627 0006703 130.5360 325.0288 15.72125391563537'
  }
];

let czml = [{ "id": "document", "version": "1.0", "clock": { "currentTime": "2024-02-10T18:03:12.657636+00:00", "multiplier": 60, "interval": "2024-02-10T18:03:12.657636+00:00/2024-02-11T18:03:12.657636+00:00", "range": "LOOP_STOP", "step": "SYSTEM_CLOCK_MULTIPLIER" } }, { "id": 25544, "description": "Orbit of Satellite: ISS (ZARYA)", "availability": "2024-02-10T18:03:12.657636+00:00/2024-02-11T18:03:12.657636+00:00", "billboard": { "show": true, "image": "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAADJSURBVDhPnZHRDcMgEEMZjVEYpaNklIzSEfLfD4qNnXAJSFWfhO7w2Zc0Tf9QG2rXrEzSUeZLOGm47WoH95x3Hl3jEgilvDgsOQUTqsNl68ezEwn1vae6lceSEEYvvWNT/Rxc4CXQNGadho1NXoJ+9iaqc2xi2xbt23PJCDIB6TQjOC6Bho/sDy3fBQT8PrVhibU7yBFcEPaRxOoeTwbwByCOYf9VGp1BYI1BA+EeHhmfzKbBoJEQwn1yzUZtyspIQUha85MpkNIXB7GizqDEECsAAAAASUVORK5CYII=", "scale": 1.5 }, "position": { "epoch": "2024-02-10T18:03:12.657636+00:00", "cartesian": [0.0, -6217536.985152482, -2310035.681524382, -1434862.361383066, 300.0, -5709053.0916941315, -3648446.1525995494, 351298.15952084714, 600.0, -4550110.58032111, -4571150.800336259, 2097294.91427101, 900.0, -2872572.3092345134, -4972863.599249115, 3603575.8629084583, 1200.0, -867716.3129782592, -4807971.489436828, 4698111.302936404, 1500.0, 1235971.4921482536, -4095565.019426468, 5256132.586912789, 1800.0, 3198976.6725157886, -2916957.229901729, 5214147.143005115, 2100.0, 4797824.325267197, -1406309.9209663717, 4576932.167053589, 2400.0, 5850270.520779324, 264475.1249298121, 3417010.7823033794, 2700.0, 6236103.846014914, 1905110.2628121243, 1866643.5471111555, 3000.0, 5911204.826788293, 3328619.787374734, 102927.40656029899, 3300.0, 4912885.56383512, 4372948.68131626, -1672576.273163581, 3600.0, 3355511.235379154, 4919718.859541607, -3257272.2889211057, 3900.0, 1416909.2386475285, 4907645.974864445, -4470957.069903458, 4200.0, -682431.607276279, 4339028.234114862, -5176210.513395007, 4500.0, -2704500.537176355, 3278907.832659061, -5293477.459604042, 4800.0, -4420273.009338643, 1847459.6871904582, -4809550.957892233, 5100.0, -5635004.038223521, 206652.87768522213, -3778962.0167330992, 5400.0, -6210025.305233612, -1457557.019824443, -2318210.986426616, 5700.0, -6078839.421273034, -2955963.481140027, -593137.7730170002, 6000.0, -5255394.696642815, -4117712.080128881, 1199636.711564735, 6300.0, -3833025.183521425, -4810179.464446205, 2855294.3207983784, 6600.0, -1973816.6178493972, -4954459.744492666, 4184633.2920473777, 6900.0, 110249.90865701041, -4534377.449439633, 5035957.056574002, 7200.0, 2181780.6013247673, -3598055.554687043, 5312314.685689517, 7500.0, 4004970.09655116, -2252186.7513793344, 4982279.110278461, 7800.0, 5372172.179495868, -649913.1765597205, 4083390.425798052, 8100.0, 6127400.811313233, 1026377.0443888025, 2718037.07749665, 8400.0, 6184321.534228575, 2585688.168835043, 1042051.0161445757, 8700.0, 5536487.794790635, 3850350.2462382712, -753036.5112003312, 9000.0, 4258211.577976685, 4676608.829995823, -2462174.8657721635, 9300.0, 2495730.69842572, 4971159.554328079, -3890622.8584798356, 9600.0, 449923.81058266276, 4701489.685975225, -4876273.020850014, 9900.0, -1646920.0487494674, 3898992.5170753733, -5307741.625703325, 10200.0, -3557264.0060750996, 2654942.7198931337, -5136412.5427118875, 10500.0, -5064611.576193166, 1110160.6943093569, -4381575.237599629, 10800.0, -5997497.044643141, -560486.6435323077, -3128397.1779999454, 11100.0, -6248954.387729164, -2167397.3335935366, -1518824.59189373, 11400.0, -5789254.647957747, -3527607.330251747, 264040.15227622405, 11700.0, -4669981.657079586, -4485891.96941814, 2016710.4927151517, 12000.0, -3018450.4320234214, -4932901.096827588, 3538874.771318795, 12300.0, -1022972.6851094094, -4817845.013364109, 4656676.027743175, 12600.0, 1089020.8119213642, -4154135.520596492, 5242681.080912495, 12900.0, 3077057.9751280285, -3017552.2717475, 5230208.232480434, 13200.0, 4714820.737066567, -1537481.543001529, 4620678.873715169, 13500.0, 5815648.484134083, 117661.19238731556, 3483460.0841119327, 13800.0, 6253821.91986235, 1759382.167603803, 1948211.5307784346, 14100.0, 5979241.4636592725, 3200585.07612138, 190291.21651085385, 14400.0, 5023464.211234446, 4277177.840639059, -1589396.5617380126, 14700.0, 3496009.264963239, 4867074.676589044, -3187754.912638491, 15000.0, 1571333.491313272, 4904061.797472202, -4422989.889606508, 15300.0, -531607.7915332349, 4384870.446249211, -5155212.789915582, 15600.0, -2574360.6397666545, 3368965.915673595, -5301813.894255487, 15900.0, -4325561.462061742, 1971538.4538533944, -4846283.02394775, 16200.0, -5586485.1309135845, 350700.24589507945, -3839945.9512349823, 16500.0, -6213258.565803141, -1309890.1109649611, -2396540.324064856, 16800.0, -6133512.770590787, -2821481.4069635156, -679901.4281699635, 17100.0, -5355319.134171046, -4011745.6218863167, 1114341.8099238707, 17400.0, -3966823.3347764984, -4744812.1604823135, 2781217.739549217, 17700.0, -2126234.773669842, -4937133.014231147, 4130235.4387512496, 18000.0, -43419.034521222355, -4567049.2921480825, 5007438.941109195, 18300.0, 2044356.1761374418, -3676995.460175189, 5312920.229466308, 18600.0, 3899433.4318021205, -2368408.607494027, 5011938.904492119, 18900.0, 5310548.105319166, -790189.3997444977, 4138728.984469054, 19200.0, 6116724.440878897, 878023.0692826697, 2792745.3534428068, 19500.0, 6225817.712298692, 2446164.421222661, 1127594.7966862086, 19800.0, 5625414.180982103, 3735549.7521702317, -666434.1404572313, 20100.0, 4384407.247255125, 4599579.5521109, -2384398.0677092173, 20400.0, 2644807.885764885, 4940617.387130581, -3830517.022867633, 20700.0, 604936.5757775417, 4720855.319045668, -4840644.037434547, 21000.0, -1503544.2341752981, 3966040.719710352, -5300607.5028156815, 21300.0, -3441762.1772713717, 2762073.9161888217, -5158576.199774471, 21600.0, -4990083.697190043, 1245248.7460091768, -4430539.786885856, 21900.0, -5972437.166892082, -412753.8052059382, -3198629.7949927724, 22200.0, -6276266.54985097, -2023808.9262642448, -1602353.5135344816, 22500.0, -5865879.678541498, -3404519.1109537105, 176733.93120759667, 22800.0, -4787213.77425006, -4397340.9997055, 1935602.1028657728, 23100.0, -3162929.444025949, -4888979.328780312, 3473233.3380838763, 23400.0, -1178227.736791397, -4823543.948702567, 4613992.770531911, 23700.0, 940673.4204382192, -4208791.484548396, 5227816.10376859, 24000.0, 2952504.598066461, -3114937.5308703175, 5244851.340353456, 24300.0, 4628243.702454801, -1666513.3342837582, 4663164.248772565, 24600.0, 5776920.07513812, -28327.842529352023, 3548949.222510897, 24900.0, 6267369.254708235, 1613070.218150474, 2029230.1164553247, 25200.0, 6043519.351182527, 3070623.908982053, 277580.3078213181, 25500.0, 5131124.604312866, 4178359.8185784165, -1505809.9912698162, 25800.0, 3634761.210509938, 4810611.055508685, -3117396.2099807695, 26100.0, 1725378.667532456, 4896321.099094801, -4373844.868648623, 26400.0, -379754.762139668, 4426690.021090617, -5132834.352094629, 26700.0, -2441901.7522010533, 3455589.2872996368, -5308722.742846865, 27000.0, -4227502.659673887, 2093158.7017837279, -4881701.200668048, 27300.0, -5533967.471321522, 493545.74133654573, -3899878.8698733454, 27600.0, -6212294.68028048, -1162030.2256354198, -2474201.386317124, 27900.0, -6184268.216840583, -2685430.0861474033, -766458.1574378172, 28200.0, -5452052.5808635, -3903011.8904155, 1028768.5758731088, 28500.0, -4098523.065118594, -4675794.772571083, 2706408.3510534414, 28800.0, -2277885.5154688265, -4915690.432412606, 4074735.4148282497, 29100.0, -197739.101858654, -4595608.63134862, 4977575.04290555, 29400.0, 1904937.764004958, -3752293.7375590736, 5312090.058693915, 29700.0, 3790786.618681774, -2481873.6606075517, 5040236.122505761, 30000.0, 5245050.459120336, -928908.3957633671, 4192933.671128235, 30300.0, 6101852.608986003, 729849.38207722, 2866677.792289293, 30600.0, 6263275.17433984, 2305422.364968855, 1212810.7653591738, 30900.0, 5710919.756369715, 3618273.014003766, -579675.142603431, 31200.0, 4508189.947893145, 4519099.636306559, -2305998.388259632, 31500.0, 2792751.6530514006, 4906044.68450351, -3769395.5118330577, 31800.0, 760222.1732118907, 4736068.312494516, -4803722.460525417, 32100.0, -1358523.1981225323, 4029283.579683431, -5292050.654731349, 32400.0, -3323429.074362598, 2866176.6857855194, -5179347.023775816, 32700.0, -4911856.830444436, 1378429.0901083488, -4478298.754001644, 33000.0, -5943228.828431125, -265590.40763700317, -3267980.8451851653, 33300.0, -6299451.267022278, -1879383.3646858672, -1685427.387854764, 33600.0, -5938869.188654794, -3279281.186212395, 89403.65015099596, 33900.0, -4901718.654714133, -4305571.697555031, 1853991.6779071093, 34200.0, -3305900.5108570335, -4841138.516367113, 3406670.426931658, 34500.0, -1333366.410332931, -4825070.200516888, 4570073.809912274, 34800.0, 791039.3377315548, -4259496.0792628545, 5211542.830382039, 35100.0, 2825408.2282324047, -3209041.8122927262, 5258073.631694374, 35400.0, 4538155.580556373, -1793308.4057851806, 4704378.087362651, 35700.0, 5734112.371425468, -173378.969674144, 3613460.908696442, 36000.0, 6276733.671711798, 1466288.9475094113, 2109678.2627321538, 36300.0, 6103988.541442004, 2938840.80185004, 364770.6340365577, 36600.0, 5235785.417531486, 4076575.8433852172, -1421838.9878687598, 36900.0, 3771662.50195738, 4750377.621699507, -3046216.1561667686, 37200.0, 1878930.6849393696, 4884436.058849677, -4323535.828547931, 37500.0, -226985.00164222348, 4464460.318558927, -5109082.334053529, 37800.0, -2307221.3253124054, 3538715.6580744074, -5314203.303262488, 38100.0, -4126167.4418546883, 2212230.048282747, -4915797.290723409, 38400.0, -5477488.55255303, 635079.6282190321, -3958745.2247987757, 38700.0, -6207132.40194573, -1014092.3795177488, -2551174.226469859, 39000.0, -6231066.069378619, -2547918.3268721914, -852784.2516342921, 39300.0, -5545521.772955389, -3791599.583744913, 942939.9261164933, 39600.0, -4228024.833077232, -4603186.711803311, 2630887.3969846144, 39900.0, -2428656.1005006195, -4890154.861976439, 4018148.781390219, 40200.0, -352595.4919186515, -4620039.248148926, 4946374.5659251185, 40500.0, 1763628.3990790904, -3823897.0278553036, 5309825.561050405, 40800.0, 3679108.561350153, -2592498.019867577, 5067164.398110059, 41100.0, 5175726.463969555, -1065963.921232989, 4245990.47094087, 41400.0, 6082794.244868879, 581970.8239730286, 2939815.4334472553, 41700.0, 6296663.984015764, 2163573.9610093515, 1297675.6489090673, 42000.0, 5792939.394612118, 3498614.7933714213, -492782.61406942905, 42300.0, 4629465.979101862, 4435236.969337111, -2226997.8778301277, 42600.0, 2939452.027450734, 4867474.196278539, -3707275.188258019, 42900.0, 915665.2124946004, 4747122.856964512, -4765519.2826752225, 43200.0, -1211963.992786707, 4088677.4807890495, -5282074.536796641, 43500.0, -3202350.6846544966, 2967175.043546131, -5198720.7189519815, 43800.0, -4829987.744981192, 1509600.6127465134, -4524840.080052523, 44100.0, -5909891.726594259, -119109.71285685986, -3336432.7974238675, 44400.0, -6318489.455302887, -1734234.8895554803, -1768023.7105782814, 44700.0, -6008167.391318221, -3151994.1406836445, 2072.4689080925436, 45000.0, -5013409.408753537, -4210660.663989618, 1771902.1595840799, 45300.0, -3447256.9916706244, -4789421.723022037, 3339204.3961600806, 45600.0, -1488272.95990107, -4822428.70842636, 4524932.095588188, 45900.0, 640229.5054285227, -4306215.552146316, 5193866.824633849, 46200.0, 2695861.662521811, -3299797.0099336957, 5269872.766562697, 46500.0, 4444622.128144346, -1917770.8350999614, 4744310.079826688, 46800.0, 5687255.084872974, -317380.9080095966, 3676978.8630608283, 47100.0, 6281906.251807644, 1319153.9795788014, 2189534.21826286, 47400.0, 6160602.320163397, 2805340.8629142866, 451839.1728836627, 47700.0, 5337366.987337722, 3971909.8109638365, -1337506.9834762253, 48000.0, 3906610.955969893, 4686426.637165013, -2974234.1416153624, 48300.0, 2031875.0688812435, 4868421.9108987395, -4272077.293213224, 48600.0, -73411.62922092354, 4498157.832088726, -5083964.2432631655, 48900.0, -2170417.6334039974, 3618285.9302122006, -5318255.299097121, 49200.0, -4021629.9241756685, 2328663.33889107, -4948563.078084978, 49500.0, -5417088.299976506, 775194.179283921, -4016530.436562991, 49800.0, -6197773.847844417, -866192.3903479993, -2627438.259427571, 50100.0, -6273869.8777042525, -2409055.190681604, -938857.0556556643, 50400.0, -5635655.403285142, -3677599.9030097085, 856879.7645406398, 50700.0, -4355231.692970814, -4527049.801339838, 2554675.452460694, 51000.0, -2578433.7148763323, -4860552.243266812, 3960491.8337930273, 51300.0, -507873.05915643956, -4640328.12036448, 4913847.078065323, 51600.0, 1620531.6645154, -3891755.269207928, 5306128.488240535, 51900.0, 3564481.327744314, -2700199.278962783, 5092717.437690784, 52200.0, 5102625.586449659, -1201251.991543393, 4297886.2938581845, 52500.0, 6059561.731376501, 434502.77734842995, 3012138.7442605994, 52800.0, 6325957.421321501, 2020731.1185059566, 1382167.2413447725, 53100.0, 5871410.173666696, 3376672.188232758, -405780.6199574735, 53400.0, 4748144.387099964, 4348061.60862332, -2147417.852675192, 53700.0, 3084799.2606536117, 4824941.7228827095, -3644173.670856599, 54000.0, 1071150.2453611554, 4754016.342053908, -4726045.840427067, 54300.0, -1063973.928570018, 4144182.1495212526, -5270682.893619639, 54600.0, -3078615.9862335143, 3064994.72194583, -5216693.146553055, 54900.0, -4744535.210912443, 1638664.6952735393, -4570152.573367957, 55200.0, -5872449.053295307, 26574.771829821206, -3403967.6273190514, 55500.0, -6333365.192031571, -1588477.3478361163, -1850121.0583873696, 55800.0, -6073720.958334196, -3022760.6844796007, -85235.51881354282, 56100.0, -5122202.0568983145, -4112686.400747151, 1689355.6828697985, 56400.0, -3586892.796187652, -4733875.028310216, 3270854.376968659, 56700.0, -1642831.8831598738, -4815627.619116145, 4478580.9053939665, 57000.0, 488354.8355070216, -4348919.546362074, 5174793.872462052, 57300.0, 2563960.522369427, -3387136.9712735442, 5280246.6534623075, 57600.0, 4347710.880139685, -2039807.4098287653, 4782950.7266836455, 57900.0, 5636381.458753289, -460222.4025485076, 3739486.3895833353, 58200.0, 6282881.164926257, 1171780.2427970292, 2268777.3102939366, 58500.0, 6213316.643941941, 2670231.126270155, 538761.9988743007, 58800.0, 5435792.667083777, 3864447.2479055305, -1252836.547894035, 59100.0, 4039505.2266321047, 4618813.3072423935, -2901470.340744703, 59400.0, 2184097.868044811, 4848297.048588061, -4219484.091097068, 59700.0, 80852.5519693859, 4527762.440191871, -5057487.731897209, 60000.0, -2031591.5605461998, 3694243.155765801, -5320878.782519316, 60300.0, -3913965.7282674517, 2442372.3145315214, -4979991.084684413, 60600.0, -5352810.148343403, 913781.9854854441, -4073219.5931612733, 60900.0, -6184224.109464752, -718445.052320313, -2702973.9714375176, 61200.0, -6312646.067557485, -2268951.4153166097, -1024653.0622920725, 61500.0, -5722385.29073228, -3561105.37446202, 770611.0728908274, 61800.0, -4480047.852093927, -4447448.716568303, 2477793.8800987666, 62100.0, -2727106.3699618974, -4826911.627068387, 3901781.148698088, 62400.0, -663457.2648134348, -4656465.60755956, 4880002.221010801, 62700.0, 1475753.5388870398, -3955820.755353145, 5301001.00865066, 63000.0, 3446988.2384928726, -2804898.101969905, 5116889.618162937, 63300.0, 5025800.7846853435, -1334669.2128141706, 4348607.801377605, 63600.0, 6032170.307085527, 287559.31126684044, 3083629.2460382218, 63900.0, 6351131.813860052, 1877007.1939317374, 1466262.5300585376, 64200.0, 5946272.355879312, 3252543.332164998, -318692.26310152956, 64500.0, 4864135.641124645, 4257646.347663905, -2067280.416641078, 64800.0, 3228684.69485979, 4778486.079514415, -3580108.833036501, 65100.0, 1226562.7034805564, 4756749.474384266, -4685313.4669135325, 65400.0, -914662.4594167871, 4195759.824511568, -5257879.960724783, 65700.0, -2952314.919163393, 3159564.6529526315, -5233260.754412297, 66000.0, -4655561.4082294395, 1765523.58710919, -4614224.879778358, 66300.0, -5830926.687026959, 171351.15633716132, -3470568.3388699344, 66600.0, -6344065.750140544, -1442225.758338771, -1931697.2631136333, 66900.0, -6135479.795905551, -2891684.23376244, -172497.22657866744, 67200.0, -5228014.336996614, -4011729.9999266984, 1606375.1585326905, 67500.0, -3724703.2128804396, -4674547.420969331, 3201639.72674719, 67800.0, -1796928.8434269566, -4804678.335407296, 4431033.440382508, 68100.0, 335528.12570460496, -4387580.385319475, 5154330.332288342, 68400.0, 2429801.1172422585, -3470998.8700226652, 5289193.710453588, 68700.0, 4247492.707607092, -2159326.0519697266, 4820290.455545126, 69000.0, 5581527.261008088, -601794.0842353057, 3800967.7882126025, 69300.0, 6279655.901595399, 1024283.5863814823, 2347386.1795647256, 69600.0, 6262090.71391818, 2533619.029514793, 625516.2211081847, 69900.0, 5530987.772567809, 3754276.1153532173, -1167851.015930207, 70200.0, 4170245.5900323465, 4547595.606683954, -2827945.125239805, 70500.0, 2335486.5493591977, 4824083.005969382, -4165770.898774895, 70800.0, 235693.1313848145, 4553256.8136228, -5029661.090965086, 71100.0, -1890844.3777071612, 3766533.7850246117, -5322074.223385576, 71400.0, -3803253.6746224784, 2553272.104649153, -5010073.845659003, 71700.0, -5284699.841909245, 1050737.7900092471, -4128798.733741797, 72000.0, -6166491.685189935, -570965.7880411565, -2777761.2351538315, 72300.0, -6347364.297010531, -2127717.80196803, -1110149.825984382, 72600.0, -5805645.476569951, -3442210.7645066613, 684157.5729284913, 72900.0, -4602379.40591008, -4364450.741925154, 2400264.204592752, 73200.0, -2874563.7637425545, -4789265.086306727, 3842033.077777647, 73500.0, -819232.2558698271, -4668444.984672094, 4844850.347277479, 73800.0, 1329400.0984488965, -4016049.2534088865, 5294445.62410414, 74100.0, 3326715.685675632, -2906516.7916734247, 5139675.421135295, 74400.0, 4945307.125896228, -1466114.5829775727, 4398142.559816624, 74700.0, 6000638.691963397, 141254.85789920486, 3154267.9154186673, 75000.0, 6372166.6821330115, 1732515.302973103, 1549939.574526955, 75300.0, 6017468.639788715, 3126328.407540654, -231541.3638279406, 75600.0, 4977352.313014215, 4164066.4096019473, -1986607.80486514, 75900.0, 3371001.5826636264, 4728148.941946517, -3515098.252965883, 76200.0, 1381787.0016350162, 4755325.941521186, -4643334.262472106, 76500.0, -764138.8395177313, 4243376.2298445795, -5243670.21025049, 76800.0, -2823540.3090891414, 3250815.629866527, -5248420.178802924, 77100.0, -4563130.3725653235, 1890082.1515053667, -4657046.489563451, 77400.0, -5785354.010761296, 315107.4833979433, -3536217.4710215027, 77700.0, -6350581.521802945, -1295594.5607839455, -2012731.2381718433, 78000.0, -6193396.462199574, -2758870.0171780265, -259688.8887600671, 78300.0, -5330766.319830143, -3907874.7740362743, 1522983.5905505768, 78600.0, -3860585.6835013605, -4611490.576536139, 3131579.435553812, 78900.0, -1950448.8062013702, -4789595.31316311, 4382303.72827432, 79200.0, 181861.6796899154, -4422173.896907653, 5132482.709839151, 79500.0, 2293482.4622767447, -3551321.9680762086, 5296712.635018562, 79800.0, 4144040.103517629, -2276237.50061316, 4856320.479672487, 80100.0, 5522731.785367571, -741986.7888003504, 3861406.9718324975, 80400.0, 6272230.984169078, 876778.9827146736, 2425340.5428693118, 80700.0, 6306886.558353973, 2395613.6029325295, 712078.3009623991, 81000.0, 5622880.131872279, 3641486.3816705705, -1082573.7841144032, 81300.0, 4298734.664032072, 4472833.9951301655, -2753678.436280735, 81600.0, 2485928.1870515523, 4795804.387938638, -4110953.2652275595, 81900.0, 390996.4781073589, 4574627.082239082, -5000492.660667222, 82200.0, -1748279.8353036218, 3835106.5409446997, -5321842.450179073, 82500.0, -3689573.92623658, 2661280.8245118386, -5038804.606960596, 82800.0, -5212806.61083671, 1185956.8307359735, -4183253.5954066953, 83100.0, -6144587.973115471, -423868.8212181761, -2851780.989205972, 83400.0, -6377997.214103673, -1985466.476673363, -1195324.3022774307, 83700.0, -5885372.701313705, -3321012.594738054, 597543.0057906506, 84000.0, -4722134.996891849, -4278125.422879032, 2322107.452812573, 84300.0, -3020695.5364085715, -4747647.78159771, 3781264.889095465, 84600.0, -975083.2505482687, -4676262.946821173, 4808401.766108518, 84900.0, 1181579.6726319725, -4072398.9973429823, 5286465.282185836, 85200.0, 3203751.1434626686, -3004980.796964899, 5161069.969473308, 85500.0, 4861203.1290614875, -1595487.866034206, 4446477.918917643, 85800.0, 5964988.372777279, -4297.6324917027705, 3224036.7743684584, 86100.0, 6389044.66883204, 1587369.6421113864, 1633175.87802451, 86400.0, 6084944.562114045, 2998129.1116618123, -144351.73086874906, 86700.0, 5087709.670154017, 4067399.0431311857, -1905421.7002025975, 87000.0, 3511643.4243493164, 4673975.044112889, -3449160.4582915427, 87300.0, 1536708.8901802015, 4749752.751303924, -4600120.188154422, 87600.0, -612514.316231655, 4286999.699312381, -5228058.633048311], "interpolationAlgorithm": "LAGRANGE", "interpolationDegree": 5, "referenceFrame": "INERTIAL" }, "label": { "show": true, "text": "ISS (ZARYA)", "horizontalOrigin": "LEFT", "pixelOffset": { "cartesian2": [12, 0] }, "fillColor": { "rgba": [197, 215, 20, 255] }, "font": "11pt Lucida Console", "outlineColor": { "rgba": [0, 0, 0, 255] }, "outlineWidth": 2 }, "path": { "show": [{ "interval": "2024-02-10T18:03:12.657636+00:00/2024-02-11T18:03:12.657636+00:00", "boolean": true }], "width": 1, "leadTime": [{ "interval": "2024-02-10T18:03:12.657636+00:00/2024-02-10T18:49:01.838246+00:00", "epoch": "2024-02-10T18:03:12.657636+00:00", "number": [0, 5576.721292656938, 5576.721292656938, 0] }, { "interval": "2024-02-10T18:49:01.838246+00:00/2024-02-10T20:21:58.559539+00:00", "epoch": "2024-02-10T18:49:01.838246+00:00", "number": [0, 5576.721292656938, 5576.721292656938, 0] }, { "interval": "2024-02-10T20:21:58.559539+00:00/2024-02-10T21:54:55.280832+00:00", "epoch": "2024-02-10T20:21:58.559539+00:00", "number": [0, 5576.721292656938, 5576.721292656938, 0] }, { "interval": "2024-02-10T21:54:55.280832+00:00/2024-02-10T23:27:52.002125+00:00", "epoch": "2024-02-10T21:54:55.280832+00:00", "number": [0, 5576.721292656938, 5576.721292656938, 0] }, { "interval": "2024-02-10T23:27:52.002125+00:00/2024-02-11T01:00:48.723418+00:00", "epoch": "2024-02-10T23:27:52.002125+00:00", "number": [0, 5576.721292656938, 5576.721292656938, 0] }, { "interval": "2024-02-11T01:00:48.723418+00:00/2024-02-11T02:33:45.444711+00:00", "epoch": "2024-02-11T01:00:48.723418+00:00", "number": [0, 5576.721292656938, 5576.721292656938, 0] }, { "interval": "2024-02-11T02:33:45.444711+00:00/2024-02-11T04:06:42.166004+00:00", "epoch": "2024-02-11T02:33:45.444711+00:00", "number": [0, 5576.721292656938, 5576.721292656938, 0] }, { "interval": "2024-02-11T04:06:42.166004+00:00/2024-02-11T05:39:38.887297+00:00", "epoch": "2024-02-11T04:06:42.166004+00:00", "number": [0, 5576.721292656938, 5576.721292656938, 0] }, { "interval": "2024-02-11T05:39:38.887297+00:00/2024-02-11T07:12:35.608590+00:00", "epoch": "2024-02-11T05:39:38.887297+00:00", "number": [0, 5576.721292656938, 5576.721292656938, 0] }, { "interval": "2024-02-11T07:12:35.608590+00:00/2024-02-11T08:45:32.329883+00:00", "epoch": "2024-02-11T07:12:35.608590+00:00", "number": [0, 5576.721292656938, 5576.721292656938, 0] }, { "interval": "2024-02-11T08:45:32.329883+00:00/2024-02-11T10:18:29.051176+00:00", "epoch": "2024-02-11T08:45:32.329883+00:00", "number": [0, 5576.721292656938, 5576.721292656938, 0] }, { "interval": "2024-02-11T10:18:29.051176+00:00/2024-02-11T11:51:25.772469+00:00", "epoch": "2024-02-11T10:18:29.051176+00:00", "number": [0, 5576.721292656938, 5576.721292656938, 0] }, { "interval": "2024-02-11T11:51:25.772469+00:00/2024-02-11T13:24:22.493762+00:00", "epoch": "2024-02-11T11:51:25.772469+00:00", "number": [0, 5576.721292656938, 5576.721292656938, 0] }, { "interval": "2024-02-11T13:24:22.493762+00:00/2024-02-11T14:57:19.215055+00:00", "epoch": "2024-02-11T13:24:22.493762+00:00", "number": [0, 5576.721292656938, 5576.721292656938, 0] }, { "interval": "2024-02-11T14:57:19.215055+00:00/2024-02-11T16:30:15.936348+00:00", "epoch": "2024-02-11T14:57:19.215055+00:00", "number": [0, 5576.721292656938, 5576.721292656938, 0] }, { "interval": "2024-02-11T16:30:15.936348+00:00/2024-02-11T18:03:12.657641+00:00", "epoch": "2024-02-11T16:30:15.936348+00:00", "number": [0, 5576.721292656938, 5576.721292656938, 0] }], "trailTime": [{ "interval": "2024-02-10T18:03:12.657636+00:00/2024-02-10T18:49:01.838246+00:00", "epoch": "2024-02-10T18:03:12.657636+00:00", "number": [0, 0, 5576.721292656938, 5576.721292656938] }, { "interval": "2024-02-10T18:49:01.838246+00:00/2024-02-10T20:21:58.559539+00:00", "epoch": "2024-02-10T18:49:01.838246+00:00", "number": [0, 0, 5576.721292656938, 5576.721292656938] }, { "interval": "2024-02-10T20:21:58.559539+00:00/2024-02-10T21:54:55.280832+00:00", "epoch": "2024-02-10T20:21:58.559539+00:00", "number": [0, 0, 5576.721292656938, 5576.721292656938] }, { "interval": "2024-02-10T21:54:55.280832+00:00/2024-02-10T23:27:52.002125+00:00", "epoch": "2024-02-10T21:54:55.280832+00:00", "number": [0, 0, 5576.721292656938, 5576.721292656938] }, { "interval": "2024-02-10T23:27:52.002125+00:00/2024-02-11T01:00:48.723418+00:00", "epoch": "2024-02-10T23:27:52.002125+00:00", "number": [0, 0, 5576.721292656938, 5576.721292656938] }, { "interval": "2024-02-11T01:00:48.723418+00:00/2024-02-11T02:33:45.444711+00:00", "epoch": "2024-02-11T01:00:48.723418+00:00", "number": [0, 0, 5576.721292656938, 5576.721292656938] }, { "interval": "2024-02-11T02:33:45.444711+00:00/2024-02-11T04:06:42.166004+00:00", "epoch": "2024-02-11T02:33:45.444711+00:00", "number": [0, 0, 5576.721292656938, 5576.721292656938] }, { "interval": "2024-02-11T04:06:42.166004+00:00/2024-02-11T05:39:38.887297+00:00", "epoch": "2024-02-11T04:06:42.166004+00:00", "number": [0, 0, 5576.721292656938, 5576.721292656938] }, { "interval": "2024-02-11T05:39:38.887297+00:00/2024-02-11T07:12:35.608590+00:00", "epoch": "2024-02-11T05:39:38.887297+00:00", "number": [0, 0, 5576.721292656938, 5576.721292656938] }, { "interval": "2024-02-11T07:12:35.608590+00:00/2024-02-11T08:45:32.329883+00:00", "epoch": "2024-02-11T07:12:35.608590+00:00", "number": [0, 0, 5576.721292656938, 5576.721292656938] }, { "interval": "2024-02-11T08:45:32.329883+00:00/2024-02-11T10:18:29.051176+00:00", "epoch": "2024-02-11T08:45:32.329883+00:00", "number": [0, 0, 5576.721292656938, 5576.721292656938] }, { "interval": "2024-02-11T10:18:29.051176+00:00/2024-02-11T11:51:25.772469+00:00", "epoch": "2024-02-11T10:18:29.051176+00:00", "number": [0, 0, 5576.721292656938, 5576.721292656938] }, { "interval": "2024-02-11T11:51:25.772469+00:00/2024-02-11T13:24:22.493762+00:00", "epoch": "2024-02-11T11:51:25.772469+00:00", "number": [0, 0, 5576.721292656938, 5576.721292656938] }, { "interval": "2024-02-11T13:24:22.493762+00:00/2024-02-11T14:57:19.215055+00:00", "epoch": "2024-02-11T13:24:22.493762+00:00", "number": [0, 0, 5576.721292656938, 5576.721292656938] }, { "interval": "2024-02-11T14:57:19.215055+00:00/2024-02-11T16:30:15.936348+00:00", "epoch": "2024-02-11T14:57:19.215055+00:00", "number": [0, 0, 5576.721292656938, 5576.721292656938] }, { "interval": "2024-02-11T16:30:15.936348+00:00/2024-02-11T18:03:12.657641+00:00", "epoch": "2024-02-11T16:30:15.936348+00:00", "number": [0, 0, 5576.721292656938, 5576.721292656938] }], "resolution": 120, "material": { "solidColor": { "color": { "rgba": [197, 215, 20, 255] } } } } }];


const CesiumMap = () => {

  useEffect(() => {

    /*
    tle_list.forEach(item => {
      let sample_position = getSamplePosition(item.tleLine1, item.tleLine2);

      viewer.entities.add({
        point: {
          pixelSize: 8,
          color: Cesium.Color.RED
        },
        label: {
          text: item.name,
          font: '14px sans-serif',
          show: true,
        },
        orientation: new Cesium.VelocityOrientationProperty(sample_position),
        position: sample_position
      });
    });
    viewer.clock.shouldAnimate = true;
    viewer.clock.multiplier = 200;
    */

    Cesium.CzmlDataSource.load(czml).then(function (data_source) {
      let viewer = new Cesium.Viewer('cesiumContainer');
      viewer.dataSources.add(data_source);
      viewer.clock.shouldAnimate = true;
      viewer.clock.multiplier = 200;



    });






    /*
    return () => {
      if (!viewer.isDestroyed()) {
        viewer.destroy();
      }
    };
    */
  }, []);

  /**
   * This function returns the postion data of each satellite rendering on the Cesium map
   * @param {TLE line 1} tleLine1 
   * @param {TLE line 2} tleLine2 
   * @returns 
   */
  function getSamplePosition(tleLine1, tleLine2) {
    let startTime = Cesium.JulianDate.now(new Date());
    let stopTime = Cesium.JulianDate.addDays(startTime, 365, new Cesium.JulianDate());

    let SampledPosition = new Cesium.SampledPositionProperty(Cesium.ReferenceFrame.INERTIAL);
    let second = parseInt(Cesium.JulianDate.secondsDifference(stopTime, startTime) / 300) + 5;
    let start = new Date(startTime);
    let satrec = satellite.twoline2satrec(tleLine1, tleLine2);

    let time_step = 0;
    let current_time = null;

    for (let i = 0; i < second; i++) {

      current_time = new Date(start.getTime() + time_step)

      let positionAndVelocity = satellite.propagate(satrec, current_time)
      let positionEci = positionAndVelocity.position

      console.log('positionAndVelocity ', positionAndVelocity);
      console.log('positionEci ', positionEci);

      let position = Cesium.Cartesian3.fromElements(positionEci.x * 1000, positionEci.y * 1000, positionEci.z * 1000)

      if (position) {

        SampledPosition.addSample(Cesium.JulianDate.fromDate(current_time), position)
        time_step += 300 * 1000

      }

      let interpolationOptions = {
        interpolationDegree: 5,
        interpolationAlgorithm: Cesium.LagrangePolynomialApproximation
      }

      SampledPosition.setInterpolationOptions(interpolationOptions)

    }

    return SampledPosition;
  }

  return <div id="cesiumContainer" style={{ height: '100vh' }} />;
};

export default CesiumMap;
